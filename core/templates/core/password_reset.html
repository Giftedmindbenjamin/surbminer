{% extends 'core/base.html' %}
{% load static %}

{% block title %}Forgot Password - Minersurb{% endblock %}

{% block content %}
<div class="auth-container">
    <!-- Floating particles -->
    <div class="auth-particles" id="authParticles"></div>
    
    <div class="auth-card">
        <h2>Reset Your Password</h2>
        <p style="text-align: center; color: var(--text-secondary); margin-bottom: 2rem;">
            Enter your email address and we'll send you a link to reset your password
        </p>
        
        {% if messages %}
        <div class="messages">
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                <i class="fas fa-{% if message.tags == 'success' %}check-circle{% elif message.tags == 'error' %}exclamation-circle{% else %}info-circle{% endif %}"></i>
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}
        
        <form method="POST" action="{% url 'core:password_reset' %}" class="auth-form" id="resetForm">
            {% csrf_token %}
            
            <div class="form-group">
                <label for="email">Email Address</label>
                <input type="email" id="email" name="email" class="form-control" 
                       placeholder="Enter your registered email address" required autofocus>
                <i class="fas fa-envelope form-icon"></i>
                <small class="password-hint" style="margin-top: 0.5rem; display: block;">
                    <i class="fas fa-info-circle"></i> We'll send a password reset link to this email
                </small>
            </div>
            
            <button type="submit" class="auth-submit-btn">
                <i class="fas fa-paper-plane"></i> Send Reset Link
            </button>
            
            <div class="auth-links">
                <a href="{% url 'core:login' %}"><i class="fas fa-arrow-left"></i> Back to Login</a>
                <span style="margin: 0 1rem; color: var(--text-muted)">|</span>
                <a href="{% url 'core:signup' %}">Create New Account</a>
            </div>
        </form>
        
        <!-- Security Info -->
        <div class="security-info" style="margin-top: 2rem; padding: 1.5rem; background: rgba(255, 255, 255, 0.05); border-radius: var(--radius-lg); border: 1px solid rgba(255, 255, 255, 0.1);">
            <h4 style="color: var(--text-primary); margin-bottom: 1rem; font-size: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                <i class="fas fa-shield-alt" style="color: var(--primary-color);"></i>
                Security Information
            </h4>
            <ul style="color: var(--text-secondary); font-size: 0.9rem; padding-left: 1.5rem; margin: 0;">
                <li>The reset link will expire in 24 hours</li>
                <li>Check your spam folder if you don't see the email</li>
                <li>Contact support if you need further assistance</li>
            </ul>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Create floating particles
    createAuthParticles();
    
    // Form submission enhancement
    const resetForm = document.getElementById('resetForm');
    if (resetForm) {
        resetForm.addEventListener('submit', function(e) {
            const submitBtn = this.querySelector('.auth-submit-btn');
            if (submitBtn) {
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';
                submitBtn.disabled = true;
                
                // Re-enable after 5 seconds if something goes wrong
                setTimeout(() => {
                    submitBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Send Reset Link';
                    submitBtn.disabled = false;
                }, 5000);
            }
        });
    }
    
    // Auto-focus on email field
    const emailInput = document.getElementById('email');
    if (emailInput) {
        emailInput.focus();
    }
});

function createAuthParticles() {
    const container = document.getElementById('authParticles');
    if (!container) return;
    
    const particleCount = 15;
    
    for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.className = 'auth-particle';
        
        // Random properties
        const size = Math.random() * 4 + 1;
        const posX = Math.random() * 100;
        const posY = Math.random() * 100;
        const delay = Math.random() * 10;
        const duration = Math.random() * 15 + 10;
        
        particle.style.width = `${size}px`;
        particle.style.height = `${size}px`;
        particle.style.left = `${posX}%`;
        particle.style.top = `${posY}%`;
        particle.style.animationDelay = `${delay}s`;
        particle.style.animationDuration = `${duration}s`;
        particle.style.opacity = Math.random() * 0.08 + 0.02;
        
        // Security-themed colors
        const colors = [
            'var(--primary-color)',
            'var(--info-color)',
            'var(--accent-color)'
        ];
        particle.style.background = colors[Math.floor(Math.random() * colors.length)];
        
        container.appendChild(particle);
    }
}
</script>
{% endblock %}